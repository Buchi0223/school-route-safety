# é€šå­¦è·¯å®‰å…¨ç¢ºèªãƒ‡ãƒ¢ã‚¢ãƒ—ãƒª - CLAUDE.md

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

Honda Safety Mapã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’å‚è€ƒã«ã—ãŸã€å°å­¦ç”Ÿã®é€šå­¦è·¯ã«ãŠã‘ã‚‹å®‰å…¨æ•™è‚²æ”¯æ´ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚
ä¿è­·è€…ãŒå­ã©ã‚‚ã¨ä¸€ç·’ã«é€šå­¦è·¯ä¸Šã®å±é™ºç®‡æ‰€ã‚’ç¢ºèªã—ã€Street Viewãƒãƒ¼ãƒãƒ£ãƒ«ãƒ„ã‚¢ãƒ¼ã§è¦–è¦šçš„ã«å­¦ç¿’ã§ãã‚‹ã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|------|-----------|------|
| Next.js | 14.x (App Router) | ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| TypeScript | 5.x | å‹å®‰å…¨æ€§ |
| Tailwind CSS | 3.x | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° |
| shadcn/ui | latest | UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| Leaflet + react-leaflet | 1.9.x / 4.x | åœ°å›³è¡¨ç¤ºï¼ˆOSMï¼‰ |
| Vitest | latest | ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |

## å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹

| ã‚µãƒ¼ãƒ“ã‚¹ | ç”¨é€” |
|---------|------|
| OpenStreetMap (OSM) | åœ°å›³ã‚¿ã‚¤ãƒ« |
| OSRM | æ­©è¡Œè€…å‘ã‘ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° |
| Google Street View API | ãƒ‘ãƒãƒ©ãƒç”»åƒè¡¨ç¤º |

## ç’°å¢ƒå¤‰æ•°

```bash
# .env.local ã«è¨­å®š
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_api_key_here
```

## ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™º
npm run dev

# ãƒ“ãƒ«ãƒ‰
npm run build

# ãƒ†ã‚¹ãƒˆ
npm run test

# Lint
npm run lint
```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
school-route-safety/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx
â”‚   â”œâ”€â”€ globals.css
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ Map/
â”‚       â”‚   â”œâ”€â”€ MapContainer.tsx      # OSMåœ°å›³è¡¨ç¤º
â”‚       â”‚   â”œâ”€â”€ RouteLayer.tsx        # çµŒè·¯æç”»
â”‚       â”‚   â””â”€â”€ HazardMarkers.tsx     # å±é™ºåœ°ç‚¹ãƒãƒ¼ã‚«ãƒ¼
â”‚       â”œâ”€â”€ StreetView/
â”‚       â”‚   â””â”€â”€ StreetViewPanel.tsx   # Street Viewè¡¨ç¤º
â”‚       â”œâ”€â”€ Guide/
â”‚       â”‚   â””â”€â”€ SafetyGuidePanel.tsx  # å®‰å…¨å­¦ç¿’ã‚¬ã‚¤ãƒ‰
â”‚       â””â”€â”€ Controls/
â”‚           â”œâ”€â”€ RouteControls.tsx     # çµŒè·¯è¨­å®šUI
â”‚           â””â”€â”€ TourControls.tsx      # ãƒ„ã‚¢ãƒ¼æ“ä½œUI
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ types.ts                      # å‹å®šç¾©
â”‚   â”œâ”€â”€ hazardData.ts                 # å±é™ºåœ°ç‚¹ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
â”‚   â””â”€â”€ routing.ts                    # OSRMé€£æº
â”œâ”€â”€ components/ui/                    # shadcn/uiã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”œâ”€â”€ public/
â”‚   â””â”€â”€ icons/
â”œâ”€â”€ __tests__/                        # ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ package.json
```

## ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©

```typescript
interface HazardPoint {
  id: string;
  type: 'intersection' | 'accident' | 'braking' | 'user_report';
  lat: number;
  lng: number;
  title: string;
  description: string;
  checkPoints: string[];
  voiceGuide: string;
  safetyTips: string[];
}

interface Route {
  id: string;
  name: string;
  waypoints: [number, number][];
  hazardPoints: string[];
}
```

## å±é™ºåœ°ç‚¹ã‚¿ã‚¤ãƒ—ã¨ã‚¢ã‚¤ã‚³ãƒ³

| type | ã‚¢ã‚¤ã‚³ãƒ³ | èª¬æ˜ |
|------|---------|------|
| intersection | âš ï¸ é»„è‰²ä¸‰è§’ | è¦‹é€šã—ã®æ‚ªã„äº¤å·®ç‚¹ |
| accident | ğŸ”´ èµ¤ä¸¸ | äº‹æ•…å¤šç™ºã‚¨ãƒªã‚¢ |
| braking | ğŸŸ  æ©™è‰² | æ€¥ãƒ–ãƒ¬ãƒ¼ã‚­å¤šç™ºåœ°ç‚¹ |
| user_report | ğŸ’¬ å¹ãå‡ºã— | ãƒ¦ãƒ¼ã‚¶ãƒ¼æŠ•ç¨¿æƒ…å ± |

## ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿åœ°åŸŸ

- ç·¯åº¦: 36.55ä»˜è¿‘
- çµŒåº¦: 139.89ä»˜è¿‘
- åœ°åŸŸ: æ ƒæœ¨çœŒå®‡éƒ½å®®å¸‚å‘¨è¾º

â€»å…·ä½“çš„ãªå‡ºç™ºç‚¹ãƒ»ç›®çš„åœ°ã¯é–‹ç™ºä¸­ã«è¨­å®š

## é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºæœ¬æ©Ÿèƒ½ï¼ˆMVPï¼‰
- [ ] Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆTypeScript, Tailwind, shadcn/uiï¼‰
- [ ] OSMåœ°å›³è¡¨ç¤ºï¼ˆLeafletï¼‰
- [ ] ã‚¯ãƒªãƒƒã‚¯ã«ã‚ˆã‚‹çµŒç”±åœ°ç‚¹è¨­å®š
- [ ] OSRMã«ã‚ˆã‚‹çµŒè·¯æç”»
- [ ] ã‚µãƒ³ãƒ—ãƒ«å±é™ºåœ°ç‚¹ã®ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤º
- [ ] å±é™ºåœ°ç‚¹ã‚¯ãƒªãƒƒã‚¯ã§Street Viewè¡¨ç¤º

### Phase 2: ãƒ„ã‚¢ãƒ¼æ©Ÿèƒ½
- [ ] çµŒè·¯ã«æ²¿ã£ãŸStreet Viewãƒãƒ¼ãƒãƒ£ãƒ«ãƒ„ã‚¢ãƒ¼
- [ ] é€²è¡Œã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼ˆå‰é€²ãƒ»å¾Œé€€ãƒ»åœæ­¢ï¼‰
- [ ] å±é™ºåœ°ç‚¹ã§ã®è‡ªå‹•åœæ­¢ãƒ»ãƒã‚¤ãƒ©ã‚¤ãƒˆ
- [ ] ç¾åœ¨ä½ç½®ã®åœ°å›³é€£å‹•

### Phase 3: ã‚¬ã‚¤ãƒ‰æ©Ÿèƒ½
- [ ] å®‰å…¨å­¦ç¿’ã‚¬ã‚¤ãƒ‰ãƒ‘ãƒãƒ«å®Ÿè£…
- [ ] ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆãƒ»å£°ã‹ã‘ä¾‹ã®è¡¨ç¤º
- [ ] å±é™ºã‚¿ã‚¤ãƒ—åˆ¥ã‚¢ã‚¤ã‚³ãƒ³ãƒ»è§£èª¬
- [ ] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³èª¿æ•´

### Phase 4: ä»•ä¸Šã’
- [ ] UIãƒ–ãƒ©ãƒƒã‚·ãƒ¥ã‚¢ãƒƒãƒ—
- [ ] QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒ»é…ç½®
- [ ] Vercelãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] å‹•ä½œç¢ºèªãƒ»å¾®èª¿æ•´

### Phase 5: ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ”¹å–„
- [ ] å…¨ä½“çš„ãªè¦‹ç›´ã—
- [ ] ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ãæ”¹å–„

## ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒãƒ¼ï¼ˆçµŒè·¯è¨­å®šãƒ»ãƒ„ã‚¢ãƒ¼é–‹å§‹/åœæ­¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚                           â”‚
â”‚                             â”‚    Street View ã‚¨ãƒªã‚¢     â”‚
â”‚     åœ°å›³è¡¨ç¤ºã‚¨ãƒªã‚¢           â”‚        (å³ä¸Š 40%)         â”‚
â”‚       (å·¦å´ 60%)            â”‚                           â”‚
â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     OSMåœ°å›³                  â”‚                           â”‚
â”‚     çµŒè·¯è¡¨ç¤º                 â”‚    ã‚¬ã‚¤ãƒ‰ãƒ‘ãƒãƒ«           â”‚
â”‚     å±é™ºåœ°ç‚¹ãƒãƒ¼ã‚«ãƒ¼          â”‚      (å³ä¸‹ 40%)           â”‚
â”‚                             â”‚    ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ        â”‚
â”‚                             â”‚    å£°ã‹ã‘ä¾‹               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ

- åœ°å›³ã¨Street Viewã‚’åˆ‡ã‚Šæ›¿ãˆè¡¨ç¤ºï¼ˆã‚¿ãƒ–å¼ï¼‰
- ã‚¬ã‚¤ãƒ‰ãƒ‘ãƒãƒ«ã¯ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³å½¢å¼
- ã‚¿ãƒƒãƒæ“ä½œã«æœ€é©åŒ–

## å¯¾å¿œè¨€èª

- æ—¥æœ¬èªã®ã¿

## ãƒ†ã‚¹ãƒˆæ–¹é‡

- ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®åŸºæœ¬çš„ãªå˜ä½“ãƒ†ã‚¹ãƒˆ
- Vitestã‚’ä½¿ç”¨

## ãƒ‡ãƒ—ãƒ­ã‚¤

- Vercelï¼ˆxxx.vercel.appï¼‰
- ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã«QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

## æ³¨æ„äº‹é …

- Google Street View API: APIã‚­ãƒ¼å¿…è¦ã€åˆ©ç”¨è¦ç´„ç¢ºèª
- Street Viewã‚«ãƒãƒ¬ãƒƒã‚¸: å…¨é“è·¯ã§åˆ©ç”¨å¯èƒ½ã§ã¯ãªã„
- OSRM: å…¬é–‹ãƒ‡ãƒ¢ã‚µãƒ¼ãƒãƒ¼ã«ã¯åˆ©ç”¨åˆ¶é™ã‚ã‚Š
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åˆ©ç”¨: ä¸å¯ï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¥ç¶šå¿…é ˆï¼‰

## å‚è€ƒãƒªãƒ³ã‚¯

- [Honda Safety Map](https://safetymap.jp/)
- [Next.js Documentation](https://nextjs.org/docs)
- [Leaflet Documentation](https://leafletjs.com/)
- [Google Street View API](https://developers.google.com/maps/documentation/streetview)
- [OSRM API](http://project-osrm.org/docs/v5.24.0/api/)
- [shadcn/ui](https://ui.shadcn.com/)
